<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matek Gyakorl√°s</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { RefreshCw, Check, LogOut, Play } = lucide;

        function MathPracticeApp() {
          const [gameState, setGameState] = useState('start');
          const [problem, setProblem] = useState(null);
          const [userAnswer, setUserAnswer] = useState('');
          const [attempts, setAttempts] = useState(0);
          const [feedback, setFeedback] = useState(null);
          const [isComplete, setIsComplete] = useState(false);
          
          const [totalProblems, setTotalProblems] = useState(0);
          const [correctAnswers, setCorrectAnswers] = useState(0);
          const [startTime, setStartTime] = useState(null);
          const [totalTime, setTotalTime] = useState(0);

          const generateProblem = () => {
            const operation = Math.random() > 0.5 ? '+' : '-';
            
            let question, answer;
            if (operation === '+') {
              const num1 = Math.floor(Math.random() * 101);
              const maxNum2 = 100 - num1;
              const num2 = Math.floor(Math.random() * (maxNum2 + 1));
              const larger = Math.max(num1, num2);
              const smaller = Math.min(num1, num2);
              question = `${larger} + ${smaller}`;
              answer = larger + smaller;
            } else {
              const num1 = Math.floor(Math.random() * 101);
              const num2 = Math.floor(Math.random() * 101);
              const larger = Math.max(num1, num2);
              const smaller = Math.min(num1, num2);
              question = `${larger} - ${smaller}`;
              answer = larger - smaller;
            }
            
            setProblem({ question, answer });
            setUserAnswer('');
            setAttempts(0);
            setFeedback(null);
            setIsComplete(false);
          };

          const handleStart = () => {
            setGameState('playing');
            setTotalProblems(0);
            setCorrectAnswers(0);
            setStartTime(Date.now());
            generateProblem();
          };

          const handleExit = () => {
            setTotalTime(Math.floor((Date.now() - startTime) / 1000));
            setGameState('results');
          };

          const handleCheck = () => {
            if (userAnswer === '') return;
            
            const isCorrect = parseInt(userAnswer) === problem.answer;
            
            if (isCorrect) {
              setFeedback({ type: 'correct', message: 'üéâ Helyes! Remek munka!' });
              setIsComplete(true);
              setCorrectAnswers(prev => prev + 1);
              setTotalProblems(prev => prev + 1);
            } else {
              const newAttempts = attempts + 1;
              setAttempts(newAttempts);
              
              if (newAttempts === 1) {
                setFeedback({ 
                  type: 'retry', 
                  message: '‚ùå Nem j√≥. Pr√≥b√°ld √∫jra!' 
                });
                setUserAnswer('');
              } else {
                setFeedback({ 
                  type: 'incorrect', 
                  message: `‚ùå Nem j√≥. A helyes v√°lasz: ${problem.answer}` 
                });
                setIsComplete(true);
                setTotalProblems(prev => prev + 1);
              }
            }
          };

          const handleRewrite = () => {
            if (!isComplete && attempts < 2) {
              setUserAnswer('');
              setFeedback(null);
            }
          };

          const handleNewProblem = () => {
            generateProblem();
          };

          const handleNumberClick = (num) => {
            if (!isComplete) {
              setUserAnswer(prev => prev + num.toString());
            }
          };

          const handleClear = () => {
            if (!isComplete) {
              setUserAnswer('');
            }
          };

          const handleBackspace = () => {
            if (!isComplete) {
              setUserAnswer(prev => prev.slice(0, -1));
            }
          };

          const formatTime = (seconds) => {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
          };

          if (gameState === 'start') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                <div className="bg-white rounded-3xl shadow-2xl p-12 w-full max-w-md text-center">
                  <h1 className="text-4xl font-bold text-indigo-600 mb-4">Matek Gyakorl√°s</h1>
                  <p className="text-gray-600 mb-8 text-lg">√ñsszead√°s √©s Kivon√°s (0-100)</p>
                  <button
                    onClick={handleStart}
                    className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold text-xl py-4 px-8 rounded-xl transition flex items-center justify-center gap-3 shadow-lg"
                  >
                    <Play size={28} />
                    Kezd√©s
                  </button>
                </div>
              </div>
            );
          }

          if (gameState === 'results') {
            const percentage = totalProblems > 0 ? Math.round((correctAnswers / totalProblems) * 100) : 0;
            
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                <div className="bg-white rounded-3xl shadow-2xl p-12 w-full max-w-md">
                  <h1 className="text-4xl font-bold text-indigo-600 mb-8 text-center">Eredm√©nyek</h1>
                  
                  <div className="space-y-6 mb-8">
                    <div className="bg-indigo-50 rounded-2xl p-6 text-center">
                      <p className="text-gray-600 mb-2">Megoldott Feladatok</p>
                      <p className="text-5xl font-bold text-indigo-600">{totalProblems}</p>
                    </div>
                    
                    <div className="bg-green-50 rounded-2xl p-6 text-center">
                      <p className="text-gray-600 mb-2">Helyes V√°laszok</p>
                      <p className="text-5xl font-bold text-green-600">{correctAnswers}</p>
                    </div>
                    
                    <div className="bg-purple-50 rounded-2xl p-6 text-center">
                      <p className="text-gray-600 mb-2">Pontoss√°g</p>
                      <p className="text-5xl font-bold text-purple-600">{percentage}%</p>
                    </div>
                    
                    <div className="bg-amber-50 rounded-2xl p-6 text-center">
                      <p className="text-gray-600 mb-2">Teljes Id≈ë</p>
                      <p className="text-5xl font-bold text-amber-600">{formatTime(totalTime)}</p>
                    </div>
                  </div>
                  
                  <button
                    onClick={handleStart}
                    className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold text-xl py-4 px-8 rounded-xl transition flex items-center justify-center gap-3 shadow-lg"
                  >
                    <Play size={28} />
                    √öj Kezd√©s
                  </button>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
              <div className="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md">
                <div className="flex justify-between items-center mb-6">
                  <div>
                    <h1 className="text-2xl font-bold text-indigo-600">Matek Gyakorl√°s</h1>
                    <p className="text-sm text-gray-600">Feladatok: {totalProblems} | Helyes: {correctAnswers}</p>
                  </div>
                  <button
                    onClick={handleExit}
                    className="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-xl transition flex items-center gap-2"
                  >
                    <LogOut size={18} />
                    Kil√©p√©s
                  </button>
                </div>

                {problem && (
                  <div className="space-y-6">
                    <div className="bg-indigo-50 rounded-2xl p-8 text-center">
                      <p className="text-5xl font-bold text-indigo-700 mb-4">
                        {problem.question}
                      </p>
                      <div className="flex items-center justify-center space-x-3">
                        <input
                          type="text"
                          inputMode="none"
                          value={userAnswer}
                          readOnly
                          disabled={isComplete}
                          className="w-32 text-3xl text-center border-2 border-indigo-300 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed bg-white cursor-default"
                          placeholder="?"
                        />
                      </div>
                    </div>

                    {feedback && (
                      <div className={`p-4 rounded-xl text-center font-medium ${
                        feedback.type === 'correct' 
                          ? 'bg-green-100 text-green-700' 
                          : feedback.type === 'retry'
                          ? 'bg-yellow-100 text-yellow-700'
                          : 'bg-red-100 text-red-700'
                      }`}>
                        {feedback.message}
                      </div>
                    )}

                    <div className="grid grid-cols-3 gap-3">
                      {[1, 2, 3, 4, 5, 6, 7, 8, 9].map(num => (
                        <button
                          key={num}
                          onClick={() => handleNumberClick(num)}
                          disabled={isComplete}
                          className="bg-indigo-100 hover:bg-indigo-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-indigo-700 text-2xl font-semibold py-4 rounded-xl transition active:scale-95"
                        >
                          {num}
                        </button>
                      ))}
                      <button
                        onClick={handleClear}
                        disabled={isComplete}
                        className="bg-red-100 hover:bg-red-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-red-700 text-lg font-semibold py-4 rounded-xl transition active:scale-95"
                      >
                        C
                      </button>
                      <button
                        onClick={() => handleNumberClick(0)}
                        disabled={isComplete}
                        className="bg-indigo-100 hover:bg-indigo-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-indigo-700 text-2xl font-semibold py-4 rounded-xl transition active:scale-95"
                      >
                        0
                      </button>
                      <button
                        onClick={handleBackspace}
                        disabled={isComplete}
                        className="bg-amber-100 hover:bg-amber-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-amber-700 text-lg font-semibold py-4 rounded-xl transition active:scale-95"
                      >
                        ‚å´
                      </button>
                    </div>

                    <div className="flex gap-3">
                      {!isComplete && (
                        <>
                          <button
                            onClick={handleCheck}
                            disabled={userAnswer === ''}
                            className="flex-1 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2"
                          >
                            <Check size={20} />
                            Ellen≈ërz√©s
                          </button>
                          <button
                            onClick={handleRewrite}
                            disabled={attempts >= 2}
                            className="flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2"
                          >
                            <RefreshCw size={20} />
                            √öjra√≠r√°s
                          </button>
                        </>
                      )}
                      
                      {isComplete && (
                        <button
                          onClick={handleNewProblem}
                          className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2"
                        >
                          <RefreshCw size={20} />
                          K√∂vetkez≈ë Feladat
                        </button>
                      )}
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MathPracticeApp />);
    </script>
</body>
</html>